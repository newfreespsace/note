---
title: 0x32 约数
updated: 2022-08-09 06:26:06Z
created: 2020-02-20 02:25:43Z
---

##### 定义：

若存在整数$q$，使得$dq = n$($d \neq 0$), 则$d$能整除$n$.

我们称$d$是$n$的约数，$n$是$d$的倍数。

默认$n \geq 0$, $d > 0$

##### 1. 约数个数定理
我们用$f(x)$表示$x$的约数个数, 那么有下面的性质。

(1)  若$p$是素数，那么$f(p^k) = k + 1$。

(2)  若$(a, b) = 1$（$a，b$互素）, 那么$f(ab) = f(a) \cdot f(b)$。

由此，我们可以得到约数个数定理：

若正整数$N$可以被唯一分解为$N={p_1}^{c_1}{p_2}^{c_2}...{P_m}^{c_m}$，其中$c_i$都是正整数，$p_i$都是质数。

那么，
$$f(N) = (c_1+1) \cdot (c_2+1) \cdot ...\cdot (c_m+1)= \prod_{i = 1}^{m}(c_i+1)$$

##### 2. 正约数和定理
我们用$h(x)$表示$x$的约数和, 那么有下面的性质。

(1)  若$p$是素数，那么$h(p^k) = 1 + p + ... + p^k$。

(2)  若$(a, b) = 1$（$a，b$互素）, 那么$h(ab) = h(a) \cdot h(b)$。

由此，我们可以得到约数个数定理：

若正整数$N$可以被唯一分解为$N={p_1}^{c_1}{p_2}^{c_2}...{P_m}^{c_m}$，其中$c_i$都是正整数，$p_i$都是质数。

那么，
$$h(N) = h({p_1}^{c_1}) \cdot h({p_2}^{c_2}) \cdot ...\cdot h({p_m}^{c_m}) \\ 
 = (1 + p_1 + ... + {p_1}^{c_1})  \cdot ...\cdot (1 + p_m + ... + {p_m}^{c_m})$$


##### 3. 求$n$的正约数集合(试除法)
依次尝试$1 \sim \sqrt n$，若能整除$n$则记录。

```c++
int factor[1600], m = 0;
void solve()
{
    for (int i = 1; i <= n / i; i++)
    {
        if (n % i == 0)
        {
            factor[++m] = i;
            if (i != n / i ) factor[++m] = n / i;
        }
    }
}
```

##### 4. 求$1 \sim N$每个数的正约数集合（倍数法）
注意到以$d$为约数的数即为$d$的倍数，依次为$d, 2d, 3d, ..., \lfloor n/d \rfloor * d$。

```c++
int n;
vector<int> factor[500010];
for (int d = 1; d <= n; d++)
{
    for (int k = 1; k <= n / d; k++)
    {
        factor[d * k].push_back(d);
    }
}
```


##### 例1
对于任何正整数$x$，其约数的个数记作$g(x)$，例如$g(1)=1$、$g(6)=4$。

如果某个正整数$x$满足：对于任意的小于$x$的正整数 $i$，都有$g(x)>g(i)$ ，则称$x$为反素数。

例如，整数$1，2，4，6$等都是反素数。

现在给定一个数$N$，请求出不超过N的最大的反素数。

【输入格式】 
一个正整数$N$。

【输出格式】
一个整数，表示不超过$N$的最大反素数。

【数据范围】
$1≤N≤2 \times 10^9$

【输入样例】
$1000$

【输出样例】
$840$

【时空限制】
1s / 64MB


#### 5. $\lfloor n/i \rfloor (1 \le i \le n )$不同的取值最多有$2 \sqrt n$个。


##### 例2 余数之和

给出正整数$n$和$k$，计算$j(n, k)=k \mod 1 + k \mod 2 + k \mod 3 + … + k \mod n$的值。

例如$j(5, 3)=3 \mod 1 + 3 \mod 2 + 3 \mod 3 + 3 \mod 4 + 3 \mod 5=0+1+0+3+3=7$。

输入格式
输入仅一行，包含两个整数$n, k$。

输出格式
输出仅一行，即$j(n, k)$。

数据范围
$1≤n,k≤10^9$

输入样例：
$5 \ \ \ 3$

输出样例：
$7$

时空限制
1s / 64MB







