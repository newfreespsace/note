---
title: 「0x35.3」异或空间
updated: 2022-10-13 08:59:32Z
created: 2022-10-13 02:43:30Z
latitude: 31.46749500
longitude: 104.67894600
altitude: 0.0000
---

若限定向量均在 $\Bbb{Z}_z^n$ 下，则称找到的基为 **异或线性基**。

在算法竞赛中，一般线性基均指异或线性基。求线性基的方法，可以直接利用高斯消元。我们用 $p$ 数组来记录每一位的线性基。

比如对于线性空间 $\{00101, 01101, 11100, 01011, 10011, 10110\}$。

第一个数 $00101$，我们检测到它的第 $2$ 位是 $1$，并且 $p[2] = 0$，记录 $p[2] = 00100$。

第二个数 $01101$，我们检测到它的第 $3$ 位是 $1$，并且 $p[3] = 0$，记录 $p[3] = 01101$。

第三个数 $01100$，我们检测到它的第 $3$ 位是 $1$，并且 $p[3] \neq 0$，于是将 $01100$ 与 $p[3]$ 作异或运算，得到 $00001$，进行检测，最终记录下 $p[0] = 00001$。

第四个数 $01011$，我们检测到它的第 $3$ 位是 $1$，并且 $p[3] \neq 0$，将其与 $p[3]$ 作异或运算，得到$00110$，继续检测，第 $2$ 位是 $1$ ，并且 $p[2] \neq 0$，与 $p[2]$ 作异或运算，得到 $00010$，继续检测，记录下 $p[1] = 00010$。

第五个数是 $10011$，检测到它的第 $4$ 位是 $1$，并且 $p[4] = 0$，记录下 $p[4] = 10011$。

第六个数是 $10110$，首先将其与 $p[4]$ 作异或运算，得到 $00101$，然后将其与 $p[2]$ 作运算，得到 $00001$，最后与 $p[0]$ 作运算，得到 $0$。结束检测。

最终，该线性空间的线性基由 $p[0]、p[1]、p[2]、p[3]、p[4]$ 组成。

#### 参考代码

```c++
bool insert(long long x) {
    for (int i = 62; i >= 0; i--) {
        if (x >> i) {
            if (p[i]) x ^= p[i]; 
            else { p[i] = x; return true; }
        }
    }
    return false;
}
```
#### 第 2 个版本
```c++
vector<ull> B;
void insert(ull x) {
    for (auto b : B) x = min(x, b ^ x);
    for (auto &b : B) b = min(b, b ^ x);
    if (x) B.push_back(x);
}
```