---
title: 4.扩展欧几里得算法
updated: 2022-09-22 00:51:51Z
created: 2019-07-06 01:51:17Z
---

####4. 扩展欧几里得算法
>我们的问题是：求解方程
$$ax+by=c$$
的所有整数解，其中$a，b$均为整数.

* ***有解的充分必要条件：$gcd(a, b)|c$***

现在我们考虑如何求解方程$ax+by=gcd(a, b)$.

回忆一下求解$gcd(a, b)$的步骤：
$$gcd(a,b)=gcd(b, a \% b)$$
这种方法叫做辗转相除法。
如：$gcd(15, 6)=gcd(6,3)=gcd(3,0)= 3$

用带余除法表示如下：
15 = 6 * 2 + 3
6  = 3 * 2 + 0
3  = 3 * 1 + 0

我们将上面的三个式子从下往上，
$3 = 3 * 1 + 0 \\
  = 3 * 1 + (6 - 3 * 2) =  6 * 1 - 3 * 1 \\
  = 6 * 1 - (15 - 6 * 2) * 1 
  = -15 * 1 + 6 * 3 $

这样我们就求出来了方程$ax+by=gcd(a,b)$的一组解$(x_0,y_0)$，我们称为特解。
通解呢？
$x = x_0 + \frac {b} {gcd(a,b)} * t$
$y = y_0 - \frac {a} {gcd(a,b)} * t$

代码(递归实现)
```c++
void gcd(int a, int b, int &d, int &x, int &y){
    if (!b){
        d = a;
        x = 1;
        y = 0;
    }
    else{
        gcd(b, a % b, d, y, x);
        y = y - (a / b) * x;
    }
}
```
记方程$ax+by=gcd(a, b)$的一组解为$(x_0,y_0)$，那么方程
$$ax+by=c$$
的一组特解可表示为$(x_0*\frac c {gcd(a, b)},y_0*\frac c {gcd(a, b)})$，由此我们便可以得到通解。

#####例1
判断下列方程是否有整数解，有解的话给出通解。

#####例2
求直线$ax+by+c=0$上有多少个整点$(x,y)$满足$x \in [x_1,y_1],y \in [y_1, y_2]$。


