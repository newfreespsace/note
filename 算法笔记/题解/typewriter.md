1. 首先，我们计算每个字符串 $S_i$ 对答案的贡献，记 $S_i$ 中不同的字符组成的集合为 $A_i$，那么该字符串对答案的贡献为 $|A_i|^L$。

2. 接下来，我们考虑任意两个集合 $A[i]$ 和 $A[j]$ 的交集 $A_{ij}$，如果我们在第一步中选择的元素仅在该交集中出现的话，那么这些元素组成的字符串被重复计算了两次。故我们需要减去由这些元素得到的字符串数量，即减去 $|A_{ij}|^L$。
3. 然后，我们再考虑任意三个集合的交集 $A_{ijk}$，交集里的元素的贡献在第二步会被减去 $3$ 次，但在第一步被加了 $3$ 次，故我们需要在此时加上它们对答案的贡献。
4. 以此类推，直到我们处理完 $n$ 个集合的交集。到底是加上还是减去每个交集对答案的贡献，取决于该交集是几个集合的交集，如果是奇数个集合的交集，则应加上贡献，否则应减去贡献。

在具体实现的时候，

首先预处理集合 $A_i$，然后枚举状态 `stat`，其二进制表示中若第 $i_1, i_2, \cdots, i_k$ 位为 $1$，则表示 stat 对应交集 $A_{i_1i_2\cdots i_k}$。通过 $k$ 的奇偶决定家还是减去交集对答案的贡献。