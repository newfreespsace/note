---
title: 国王游戏
updated: 2023-09-22 01:48:17Z
created: 2023-09-22 01:17:18Z
latitude: 30.57281600
longitude: 104.06680100
altitude: 0.0000
---

对于任意一种顺序，设 $n$ 名大臣左右手的顺序分别是 $A[1] \sim A[n]$，$B[1] \sim B[n]$。国王手上的数是 $A[0]$ 和 $B[0]$。

现在我们考虑大臣 $i$ 和 大臣 $i + 1$。

大臣 $i$ 获得的奖励是 $\displaystyle \frac 1{B[i]} \times \prod_{j=0}^{i-1} A[j]$。

大臣 $i+1$ 获得的奖励是 $\displaystyle \frac 1{B[i+1]} \times \prod_{j=0}^{i} A[j]$。

交换后不影响其余大臣，故我们只需要考虑对这两名大臣的影响。

大臣 $i$ 获得的奖励变成是 $\displaystyle \frac {A[i+1]}{B[i]} \times \prod_{j=0}^{i-1} A[j]$。

大臣 $i+1$ 获得的奖励是 $\displaystyle \frac 1{B[i+1]} \times \prod_{j=0}^{i - 1} A[j]$。

一个不影响它们大小关系的处理，我们可以将上面出现的四个数都除以  $\displaystyle \prod_{j=0}^{i - 1} A[j]$，再乘上 $B[i] \cdot B[i+1]$。

这样，交换前，大臣 $i$ 和大臣 $i + 1$ 获得的奖励分别是 $B[i + 1]$ 和 $A[i] \cdot B[i]$。

交换后，大臣 $i$ 和大臣 $i + 1$ 获得的奖励分别是 $A[i + 1] \cdot B[i + 1]$ 和 $B[i]$。

可以看到，大臣 $i$ 的奖励变多了，大臣 $i + 1$ 的奖励变少了。这很正常，因为大臣 $i$ 向后移动了一位，而大臣 $i + 1$ 向前移动了一位。但是，我们关心的是交换后最大值的变化情况。

注意到 $B[i] \le B[i] \cdot A[i]$，而 $B[i+1] \le A[i+1] \cdot B[i + 1]$。故交换前后的最大值变换取决与 $A[i] \cdot B[i]$ 与 $A[i + 1] \cdot B[i + 1]$ 和 $B[i]$ 的大小关系。如果前者大，那么 $\max \{B[i + 1]$, $A[i] \cdot B[i]\} > \max \{ A[i + 1] \cdot B[i + 1]$, $B[i]\}$ 。这种情况下交换前更优，反之交换后更优。

通过上面的分析，我们可以得到本题的贪心解法，按照 $A[i] \cdot B[i]$，从小到大进行排序。再统计每个大臣获得奖励的最大值。本题因为数据范围较大，需利用高精乘法和除法。

