---
title: 前缀和
updated: 2022-08-09 06:26:09Z
created: 2019-11-07 13:58:24Z
---

### 前缀和
>一串长度为$n$的数列$a_1,a_2,a_3......a_n$,再给出$m$个询问，每次询问给出$L，R$两个数，要求给出区间$[L,R]$里的数的和。

如果我们直接求的话，每次求和的时间复杂度为$O(n)$，m次询问，总共的时间复杂度为$O(nm)$
现在我们引入前缀和的概念：
```c++
pre[i] = pre[i - 1] + a[i];  // 即数列中的前n项和Sn
```
在求区间和之前，我们花费$O(n)$的时间求出数列的前缀和，这样，在询问区间$[L,R]$里的数的和时候，我们只需调用$pre[R]-pre[L-1]$即可返回区间和。共需调用m次，所有总共的时间复杂度为$O(n+m)$。

### 差分

一串长度为$n$的数列$a_1,a_2,a_3......a_n$，$m$次操作，每次给出$L,R$两个数：

操作一：将$[L,R]$内的元素都加上$P$

最后再给出一个询问求$[L,R]$内的元素之和？

如果我们直接处理的话，每次操作花费$O(n)$,总共m次操作，最后查询花费$O(n)$，所以总共的时间复杂度为$O(nm+n)$

差分可以视为前缀和的逆变形
```c++
for (int i = 1; i <= n;; i++)
{
    p[i] = a[i] - a[i - 1];
}
```
区间[L,R]内元素均加上P
```c++
p[L] += P;
P[R + 1] -= p;
```

