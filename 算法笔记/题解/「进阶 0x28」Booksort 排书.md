### 如何搜索

枚举每一个区间 $[i, j]$，其中 $0 \le i < n, 0 \le j < n$。然后再枚举将该区间移动到哪一个位置之后，注意到区间向前移动与将合适的区间向后移动重复，故我们可以只需枚举区间后面的位置 $k$。

![image-20231218112545362](C:\Users\Lee\OneDrive\笔记\算法学习\题解\assets\image-20231218112545362.png)



![image-20231218112604769](C:\Users\Lee\OneDrive\笔记\算法学习\题解\assets\image-20231218112604769.png)

```c++
int tmp[N];
memcpy(tmp, A, sizeof A);
for (int x = i; x <= j; x++) A[x - j + k] = tmp[x];
for (int x = j + 1; x <= k; x++) A[x - j - 1 + i] = tmp[x];
```

因为 $n \le 15$，需枚举的量为 $n^3/6$，其上限大约为 560。如果直接深搜，搜索规模为 $560^4$，无法通过本题。

### 估价函数

如果 $A[i] + 1 == A[i + 1]$，我们称 $A[i]$ 具有正确的后继，否则为错误的后继，每次移动，我们最多消掉 $3$ 个错误的后继，故估价函数可以设计为 $f(stat) = \lceil tot / 3 \rceil$。其中 $tot$ 表示错误后继的个数。





